<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Settings</title>
    <link rel="stylesheet" href="mobile.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  </head>
  <body>
    <div class="top_header">
      <div class="header">
        <h1>Settings</h1>
        <h3>Customize Your Experience ⚙️</h3>
        <a href="index.html" class="notification_icon_top">
          <i class="fas fa-bell"></i>
          <span class="notification_badge">0</span>
        </a>
      </div>
      <div class="bottom_div">
        
        <!-- Notification Settings -->
        <div class="settings_category">
          <h3><i class="fas fa-bell"></i> Notifications</h3>
          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Push Notifications</h4>
              <p>Get notified about your tasks</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" checked />
              <span class="toggle_slider"></span>
            </div>
          </div>

          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Email Reminders</h4>
              <p>Receive daily task reminders</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" />
              <span class="toggle_slider"></span>
            </div>
          </div>

          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Sound Effects</h4>
              <p>Play sounds on task completion</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" checked />
              <span class="toggle_slider"></span>
            </div>
          </div>
        </div>

        <!-- Display Settings -->
        <div class="settings_category">
          <h3><i class="fas fa-palette"></i> Display</h3>
          
          <div class="settings_select_item">
            <label>Theme</label>
            <div class="theme_switcher">
              <div class="theme_option" data-theme="light">
                <i class="fas fa-sun"></i> Light
              </div>
              <div class="theme_option" data-theme="dark">
                <i class="fas fa-moon"></i> Dark
              </div>
            </div>
          </div>

          <div class="settings_select_item">
            <label>Font Size</label>
            <select class="settings_select">
              <option>Small</option>
              <option>Medium (Default)</option>
              <option>Large</option>
            </select>
          </div>

          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Dark Mode</h4>
              <p>Reduce eye strain in low light</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" />
              <span class="toggle_slider"></span>
            </div>
          </div>
        </div>

        <!-- Task Settings -->
        <div class="settings_category">
          <h3><i class="fas fa-tasks"></i> Tasks</h3>
          
          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Show Completed Tasks</h4>
              <p>Display finished tasks in the list</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" checked />
              <span class="toggle_slider"></span>
            </div>
          </div>

          <div class="settings_select_item">
            <label>Sort By</label>
            <select class="settings_select">
              <option>Due Date</option>
              <option>Priority</option>
              <option>Recently Added</option>
            </select>
          </div>

          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Recurring Tasks</h4>
              <p>Enable repeated tasks</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" checked />
              <span class="toggle_slider"></span>
            </div>
          </div>
        </div>

        <!-- Privacy Settings -->
        <div class="settings_category">
          <h3><i class="fas fa-lock"></i> Privacy & Security</h3>
          
          <div class="settings_toggle_item">
            <div class="toggle_content">
              <h4>Two-Factor Authentication</h4>
              <p>Add extra security to your account</p>
            </div>
            <div class="toggle_switch">
              <input type="checkbox" class="toggle_checkbox" />
              <span class="toggle_slider"></span>
            </div>
          </div>

          <div class="settings_button_item">
            <div class="button_content">
              <h4><i class="fas fa-trash"></i> Clear Cache</h4>
              <p>Remove cached data</p>
            </div>
            <button class="action_btn">Clear</button>
          </div>

          <div class="settings_button_item">
            <div class="button_content">
              <h4><i class="fas fa-download"></i> Export Data</h4>
              <p>Download your data</p>
            </div>
            <button class="action_btn">Export</button>
          </div>
        </div>

        <!-- About Section -->
        <div class="settings_category">
          <h3><i class="fas fa-info-circle"></i> About</h3>
          
          <div class="about_item">
            <div class="about_content">
              <h4>App Version</h4>
              <p>v1.0.0</p>
            </div>
          </div>

          <div class="about_item">
            <div class="about_content">
              <h4>Last Updated</h4>
              <p>January 31, 2026</p>
            </div>
          </div>

          <div class="settings_button_item">
            <div class="button_content">
              <h4><i class="fas fa-envelope"></i> Send Feedback</h4>
              <p>Help us improve the app</p>
            </div>
            <button class="action_btn">Send</button>
          </div>
        </div>

      </div>

      <!-- Footer Nav -->
      <div class="footer_nav">
        <a href="index.html" class="footer_link"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="newtask.html" class="footer_link"><i class="fas fa-plus-circle"></i><span>New Task</span></a>
        <a href="#" class="footer_link" id="completedTasksLink"><i class="fas fa-check-circle"></i><span>Completed</span></a>
        <a href="profile.html" class="footer_link"><i class="fas fa-user"></i><span>Profile</span></a>
        <a href="settings.html" class="footer_link"><i class="fas fa-cog"></i><span>Settings</span></a>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      // Settings page specific functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Clear Cache functionality
        const clearCacheBtn = document.querySelector('.settings_button_item .action_btn');
        if (clearCacheBtn && clearCacheBtn.textContent.trim() === 'Clear') {
          clearCacheBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to clear all cached data? This will remove all tasks and settings.')) {
              localStorage.clear();
              sessionStorage.clear();
              notificationManager.success('Cache cleared successfully!');
              setTimeout(() => {
                window.location.href = 'login.html';
              }, 1000);
            }
          });
        }

        // Export Data functionality
        const exportDataBtn = document.querySelectorAll('.settings_button_item .action_btn')[1];
        if (exportDataBtn && exportDataBtn.textContent.trim() === 'Export') {
          exportDataBtn.addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const completedTasks = taskManager.getCompletedTasks();
            const user = userManager.getUser();
            
            // Golden theme colors
            const primaryColor = [244, 201, 122]; // #f4c97a golden
            const secondaryColor = [217, 140, 124]; // #d98c7c coral
            const textColor = [51, 51, 51]; // #333
            const lightGray = [248, 249, 250]; // #f8f9fa
            
            // Header with app theme
            doc.setFillColor(...primaryColor);
            doc.rect(0, 0, 210, 40, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(24);
            doc.text('DAILY ROUTINE', 20, 25);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(14);
            doc.text('Completed Tasks Report', 20, 35);
            
            // User info card
            doc.setTextColor(...textColor);
            doc.setFillColor(...lightGray);
            doc.rect(15, 50, 180, 25, 'F');
            doc.setDrawColor(...secondaryColor);
            doc.rect(15, 50, 180, 25, 'S');
            
            doc.setFontSize(12);
            doc.text(`User: ${user.name}`, 20, 62);
            doc.text(`Export Date: ${new Date().toLocaleDateString()}`, 20, 70);
            doc.text(`Completed: ${completedTasks.length} tasks`, 120, 62);
            doc.text(`Success Rate: ${taskManager.getCompletionPercentage()}%`, 120, 70);
            
            let yPos = 90;
            
            if (completedTasks.length === 0) {
              doc.setFontSize(16);
              doc.setTextColor(158, 158, 158);
              doc.text('No completed tasks yet. Keep going!', 20, yPos);
            } else {
              completedTasks.forEach((task, index) => {
                if (yPos > 260) {
                  doc.addPage();
                  yPos = 30;
                }
                
                // Task card with theme colors
                doc.setFillColor(252, 252, 252);
                doc.rect(15, yPos - 5, 180, 20, 'F');
                doc.setDrawColor(...primaryColor);
                doc.rect(15, yPos - 5, 180, 20, 'S');
                
                // Task number and checkmark
                doc.setTextColor(...primaryColor);
                doc.setFontSize(10);
                doc.text(`#${index + 1}`, 20, yPos + 2);
                doc.text('✓', 30, yPos + 2);
                
                // Task title
                doc.setTextColor(...textColor);
                doc.setFontSize(12);
                doc.text(task.title, 40, yPos + 2);
                
                yPos += 8;
                
                // Task details with proper text encoding
                doc.setFontSize(9);
                doc.setTextColor(117, 117, 117);
                let details = [];
                if (task.dueDate) details.push(`Date: ${new Date(task.dueDate).toLocaleDateString()}`);
                if (task.category) details.push(`Category: ${task.category}`);
                if (task.priority) details.push(`Priority: ${task.priority}`);
                
                if (details.length > 0) {
                  doc.text(details.join('  |  '), 20, yPos + 2);
                  yPos += 8;
                }
                
                yPos += 10;
              });
            }
            
            // Footer with theme color
            doc.setFillColor(...primaryColor);
            doc.rect(0, 287, 210, 10, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(8);
            doc.text('Generated by Daily Routine App', 20, 293);
            doc.text('Created by :- Rajesh Ranjan', 120, 293);
            
            doc.save(`completed-tasks-${new Date().toISOString().split('T')[0]}.pdf`);
            notificationManager.success('PDF exported with app theme!');
          });
        }

        // Sound Effects toggle
        const soundToggle = document.querySelectorAll('.toggle_checkbox')[2];
        if (soundToggle) {
          soundToggle.checked = settingsManager.getSetting('soundEffects');
          soundToggle.addEventListener('change', function() {
            settingsManager.updateSetting('soundEffects', this.checked);
            notificationManager.success(this.checked ? 'Sound effects enabled!' : 'Sound effects disabled!');
          });
        }

        // Show Completed Tasks toggle
        const completedTasksToggle = document.querySelectorAll('.toggle_checkbox')[4];
        if (completedTasksToggle) {
          completedTasksToggle.checked = settingsManager.getSetting('showCompletedTasks');
          completedTasksToggle.addEventListener('change', function() {
            settingsManager.updateSetting('showCompletedTasks', this.checked);
            notificationManager.success(this.checked ? 'Completed tasks will be shown!' : 'Completed tasks will be hidden!');
          });
        }

        // Recurring Tasks toggle
        const recurringTasksToggle = document.querySelectorAll('.toggle_checkbox')[6];
        if (recurringTasksToggle) {
          recurringTasksToggle.checked = settingsManager.getSetting('recurringTasks');
          recurringTasksToggle.addEventListener('change', function() {
            settingsManager.updateSetting('recurringTasks', this.checked);
            notificationManager.success(this.checked ? 'Recurring tasks enabled!' : 'Recurring tasks disabled!');
          });
        }
      });
    </script>
  </body>
</html>
